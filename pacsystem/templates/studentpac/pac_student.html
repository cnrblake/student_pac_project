{% extends 'studentpac/base.html' %}

{% block title %}PAC Students{% endblock %}

{% block content %}
<h1 class="h4 mb-3">PAC Students</h1>

<div class="mb-3">
    <label for="pac-select" class="form-label">Select a PAC</label>
    <select id="pac-select" class="form-select">
        <option value="" selected disabled>Select a PAC...</option>
        {% for pac in pacs %}
            <option value="pac-{{ pac.PacID }}">{{ pac.FirstName }} {{ pac.LastName }} ({{ pac.PacID }})</option>
        {% endfor %}
    </select>
</div>

<div id="pac-tables">
    {% for pac in pacs %}
        <div class="pac-table" id="pac-{{ pac.PacID }}" style="display: none;">
            <h2 class="h6">Students for {{ pac.FirstName }} {{ pac.LastName }}</h2>
            {% if pac.studenttable_set.all %}
                <div class="table-responsive">
                    <table class="table table-striped table-sm">
                        <thead>
                            <tr>
                                <th>Student ID</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in pac.studenttable_set.all %}
                                <tr>
                                    <td>{{ student.StudentID }}</td>
                                    <td>{{ student.FirstName }}</td>
                                    <td>{{ student.LastName }}</td>
                                    <td>{{ student.Email }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="text-muted">No students assigned to this PAC.</p>
            {% endif %}
        </div>
    {% endfor %}
</div>

<script>
    const pacSelect = document.getElementById('pac-select');
    const pacTables = document.querySelectorAll('.pac-table');

    pacSelect.addEventListener('change', (event) => {
        pacTables.forEach((table) => {
            table.style.display = table.id === event.target.value ? 'block' : 'none';
        });
    });
</script>
{% endblock %}

